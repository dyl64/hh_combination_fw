#!/usr/bin/env python

# - Here you can find the factors used to scale the different POIs


################################
### --- Branching ratios --- ###
################################

# - Taken from https://twiki.cern.ch/twiki/bin/view/LHCPhysics/CERNYellowReportPageBR

br_h_WW = { 125.00 : 0.2137,
            125.09 : 0.2152,
            'bbWW' : 0.213 }
br_h_bb = { 125.00 : 0.5824,
            125.09 : 0.5809,
            'bbWW' : 0.5770 }
br_h_yy = { 125.00 : 2.270e-3,
            125.09 : 2.270e-3 }


br_hh_bbyy = { 125.0  : 2.0*br_h_bb[125.0] *br_h_yy[125.0],
               125.09 : 2.0*br_h_bb[125.09]*br_h_yy[125.09]
             } 


fb_to_pb = 1.0e-3

lambda_bbbb_correction = 11.3*(fb_to_pb / br_h_bb[125.00]**2)

mH = 125.09

####################
### --- bbbb --- ###
####################

bbbb_scalings = {

# - v00: For the first preliminary workspaces presented in HH combination meeting on 2019-11-14
            'v00' : {
                        'nonres' :
                        {
                               '0' : 31.04/1000.
                        },
                        'nonres_statOnly' :
                        {
                               '0' : 31.04/1000.
                        },
                        'spin0' : 
                        {
                             '251' : 27009.1/1000.,        
                             '260' : 76167.4/1000.,
                             '280' : 104616/1000.,
                             '300' : 110864/1000.,
                             '350' : 124575/1000.,
                             '400' : 114117/1000.,
                             '500' : 49323.1/1000.,
                             '600' : 19365.6/1000.,
                             '700' : 7963.74/1000.,
                             '800' : 3492.06/1000.,
                             '900' : 1627.38/1000.,
                            '1000' : 800.308/1000.,
                            '1100' : 412.332/1000.,
                            '1200' : 221.131/1000.,
                            '1300' : 122.845/1000.,
                            '1400' : 70.3365/1000.,
                            '1500' : 41.3654/1000.,
                            '1600' : 24.9041/1000.,
                            '1800' : 9.58681/1000.,
                            '2000' : 3.94456/1000.,
                            '2500' : 0.530204/1000.,
                            '3000' : 0.0877307/1000.,
                            '4000' : 1.0,
                            '5000' : 1.0,
                        },
                        'spin2_c_1.0' : 
                        {
                            '300' : 1.3199,
                            '400' : 1.901,
                            '500' : 0.8924,
                            '600' : 0.4104,
                            '700' : 0.20148,
                            '800' : 0.10549,
                            '900' : 0.05835,
                           '1000' : 0.03368,
                           '1100' : 0.02023,
                           '1200' : 0.01254,
                           '1300' : 0.007979,
                           '1400' : 0.005201,
                           '1500' : 0.003450,
                           '1600' : 0.002336,
                           '1800' : 0.001116,
                           '2000' : 5.559e-4,
                           '2250' : 2.486e-4,
                           '2500' : 1.158e-4,
                           '2750' : 5.585e-5,
                           '3000' : 2.772e-5
                        }
                     },

                }

########################
### --- bbtautau --- ###
########################

bbtautau_scalings = {
# - v00: For the first preliminary workspaces presented in HH combination meeting on 2019-11-14
                'v00' : {
                                'nonres' :
                                {
                                   '0' : 31.05
                                   #'0' : 31.05/(1000.*0.5825*0.06272*2)
                                   #'0' : 0.0050032*0.5*1000/(0.577*0.0632*2)  #2018-07-26: updated BRs (0.5825*0.06272 -> 0.577*0.0632) since it turned out that bbtautau uses these values to calculate limits on xs/xs_SM
                                },
                                'nonres_statOnly' :
                                {
                                   '0' : 31.05
                                   #'0' : 0.0050032*0.5*1000/(0.577*0.0632*2)  #2018-07-26: updated BRs (0.5825*0.06272 -> 0.577*0.0632) since it turned out that bbtautau uses these values to calculate limits on xs/xs_SM
                                },
                                'spin0' : 
                                {
                                   '260' : 1.0,
                                   '275' : 1.0,
                                   '300' : 1.0,
                                   '325' : 1.0,
                                   '350' : 1.0,
                                   '400' : 1.0,
                                   '450' : 1.0,
                                   '500' : 1.0,
                                   '550' : 1.0,
                                   '600' : 1.0,
                                   '700' : 1.0,
                                   '800' : 1.0,
                                   '900' : 1.0,
                                  '1000' : 1.0,
                                  '1100' : 0.01,
                                  '1200' : 0.01,
                                  '1400' : 0.01,
                                  '1600' : 0.01,
                                  '1800' : 0.01,
                                  '2000' : 0.01,
                                  '2500' : 0.01,
                                  '3000' : 0.01,
                                },
                                'spin0_statOnly' : 
                                {
                                   '260' : 441.86,
                                   '275' : 583.18,
                                   '300' : 634.98,
                                   '325' : 643.57,
                                   '350' : 709.81,
                                   '400' : 646.17,
                                   '450' : 438.32,
                                   '500' : 276.90,
                                   '550' : 172.43,
                                   '600' : 107.99,
                                   '700' : 44.137,
                                   '800' : 19.260,
                                   '900' : 8.9208,
                                  '1000' : 4.3747
                                },
                                'spin2_c_1.0' : 
                                {
                                    '260' : 1e3*0.2719,
                                    '300' : 1.3199,
                                    '400' : 1.901,
                                    '500' : 0.8924,
                                    '600' : 0.4104,
                                    '700' : 0.20148,
                                    '800' : 0.10549,
                                    '900' : 0.05835,
                                    '1000': 0.03368
                                },
                                'spin2_c_1.0_statOnly' : 
                                {
                                    '260' : 1e3*0.2719,
                                    '300' : 1.3199,
                                    '400' : 1.901,
                                    '500' : 0.8924,
                                    '600' : 0.4104,
                                    '700' : 0.20148,
                                    '800' : 0.10549,
                                    '900' : 0.05835,
                                    '1000': 0.03368
                                },
                                'spin2_c_2.0' : 
                                {
                                    '260' : 1e3*8.7134,
                                    '275' : 8.9536,
                                    '300' : 9.9983,
                                    '325' : 10.886,
                                    '350' : 11.085,
                                    '400' : 8.5579,
                                    '450' : 5.7364,
                                    '500' : 3.7496,
                                    '550' : 2.4708,
                                    '600' : 1.6569,
                                    '700' : 0.78979,
                                    '800' : 0.40415,
                                    '900' : 0.21937,
                                    '1000': 0.12499
                                },
                                'spin2_c_2.0_statOnly' : 
                                {
                                    '260' : 1e3*8.7134,
                                    '275' : 8.9536,
                                    '300' : 9.9983,
                                    '325' : 10.886,
                                    '350' : 11.085,
                                    '400' : 8.5579,
                                    '450' : 5.7364,
                                    '500' : 3.7496,
                                    '550' : 2.4708,
                                    '600' : 1.6569,
                                    '700' : 0.78979,
                                    '800' : 0.40415,
                                    '900' : 0.21937,
                                    '1000': 0.12499
                                },
                                'lambda' : 
                                {
                                    '-20': 1000.*1.0247*4.9883452344885288,
                                    '-19': 1000.*1.0247*4.5541647139249211,
                                    '-18': 1000.*1.0247*4.1398074634572692,
                                    '-17': 1000.*1.0247*3.7452734830855734,
                                    '-16': 1000.*1.0247*3.3705627728098331,
                                    '-15': 1000.*1.0247*3.0156753326300487,
                                    '-14': 1000.*1.0247*2.6806111625462199,
                                    '-13': 1000.*1.0247*2.365370262558347,
                                    '-12': 1000.*1.0247*2.0699526326664297,
                                    '-11': 1000.*1.0247*1.7943582728704679,
                                    '-10': 1000.*1.0247*1.5385871831704621,
                                    '-9' : 1000.*1.0247*1.3026393635664117,
                                    '-8' : 1000.*1.0247*1.0865148140583174,
                                    '-7' : 1000.*1.0247*0.89021353464617869,
                                    '-6' : 1000.*1.0247*0.71373552532999573,
                                    '-5' : 1000.*1.0247*0.55708078610976841,
                                    '-4' : 1000.*1.0247*0.42024931698549683,
                                    '-3' : 1000.*1.0247*0.30324111795718101,
                                    '-2' : 1000.*1.0247*0.20605618902482087,
                                    '-1' : 1000.*1.0247*0.12869453018841642,
                                    '0'  : 1000.*1.0247*0.071156141447967752,
                                    '1'  : 1000.*1.0247*0.033441022803474781,
                                    '2'  : 1000.*1.0247*0.015549174254937528,
                                    '3'  : 1000.*1.0247*0.017480595802355989,
                                    '4'  : 1000.*1.0247*0.039235287445730183,
                                    '5'  : 1000.*1.0247*0.08081324918506011,
                                    '6'  : 1000.*1.0247*0.1422144810203457,
                                    '7'  : 1000.*1.0247*0.22343898295158704,
                                    '8'  : 1000.*1.0247*0.3244867549787841,
                                    '9'  : 1000.*1.0247*0.4453577971019369,
                                    '10' : 1000.*1.0247*0.58605210932104546,
                                    '11' : 1000.*1.0247*0.74656969163610964,
                                    '12' : 1000.*1.0247*0.92691054404712958,
                                    '13' : 1000.*1.0247*1.1270746665541052,
                                    '14' : 1000.*1.0247*1.3470620591570368,
                                    '15' : 1000.*1.0247*1.586872721855924,
                                    '16' : 1000.*1.0247*1.8465066546507667,
                                    '17' : 1000.*1.0247*2.1259638575415654,
                                    '18' : 1000.*1.0247*2.4252443305283196,
                                    '19' : 1000.*1.0247*2.7443480736110293,
                                    '20' : 1000.*1.0247*3.0832750867896954
                                },
                                'lambda_statOnly' : 
                                {
                                    '-20': 1000.*1.0247*4.9883452344885288,
                                    '-19': 1000.*1.0247*4.5541647139249211,
                                    '-18': 1000.*1.0247*4.1398074634572692,
                                    '-17': 1000.*1.0247*3.7452734830855734,
                                    '-16': 1000.*1.0247*3.3705627728098331,
                                    '-15': 1000.*1.0247*3.0156753326300487,
                                    '-14': 1000.*1.0247*2.6806111625462199,
                                    '-13': 1000.*1.0247*2.365370262558347,
                                    '-12': 1000.*1.0247*2.0699526326664297,
                                    '-11': 1000.*1.0247*1.7943582728704679,
                                    '-10': 1000.*1.0247*1.5385871831704621,
                                    '-9' : 1000.*1.0247*1.3026393635664117,
                                    '-8' : 1000.*1.0247*1.0865148140583174,
                                    '-7' : 1000.*1.0247*0.89021353464617869,
                                    '-6' : 1000.*1.0247*0.71373552532999573,
                                    '-5' : 1000.*1.0247*0.55708078610976841,
                                    '-4' : 1000.*1.0247*0.42024931698549683,
                                    '-3' : 1000.*1.0247*0.30324111795718101,
                                    '-2' : 1000.*1.0247*0.20605618902482087,
                                    '-1' : 1000.*1.0247*0.12869453018841642,
                                    '0'  : 1000.*1.0247*0.071156141447967752,
                                    '1'  : 1000.*1.0247*0.033441022803474781,
                                    '2'  : 1000.*1.0247*0.015549174254937528,
                                    '3'  : 1000.*1.0247*0.017480595802355989,
                                    '4'  : 1000.*1.0247*0.039235287445730183,
                                    '5'  : 1000.*1.0247*0.08081324918506011,
                                    '6'  : 1000.*1.0247*0.1422144810203457,
                                    '7'  : 1000.*1.0247*0.22343898295158704,
                                    '8'  : 1000.*1.0247*0.3244867549787841,
                                    '9'  : 1000.*1.0247*0.4453577971019369,
                                    '10' : 1000.*1.0247*0.58605210932104546,
                                    '11' : 1000.*1.0247*0.74656969163610964,
                                    '12' : 1000.*1.0247*0.92691054404712958,
                                    '13' : 1000.*1.0247*1.1270746665541052,
                                    '14' : 1000.*1.0247*1.3470620591570368,
                                    '15' : 1000.*1.0247*1.586872721855924,
                                    '16' : 1000.*1.0247*1.8465066546507667,
                                    '17' : 1000.*1.0247*2.1259638575415654,
                                    '18' : 1000.*1.0247*2.4252443305283196,
                                    '19' : 1000.*1.0247*2.7443480736110293,
                                    '20' : 1000.*1.0247*3.0832750867896954
                                },

    
                             }
                    }



####################
### --- bbyy --- ###
####################

bbyy_scalings = {

# - v00: For the first preliminary workspaces presented in HH combination meeting on 2019-11-14
                   'v00':{
                             'nonres' :
                             {
                                  '0' : 31.05/1000.
                                  #'0' : 1.0
                             },
                             'nonres_statOnly' :
                             {
                                  '0' : 31.05/1000.
                             },
                             'spin0' : 
                             {
                                  '260' : 1.0,
                                  '275' : 1.0,
                                  '280' : 1.0,
                                  '300' : 1.0,
                                  '325' : 1.0,
                                  '350' : 1.0,
                                  '400' : 1.0,
                                  '450' : 1.0,
                                  '500' : 1.0,
                                  '550' : 1.0,
                                  '600' : 1.0,
                                  '700' : 1.0,
                                  '800' : 1.0,
                                  '900' : 1.0,
                                  '1000' : 1.0,
                             },
                             'spin0_statOnly' : 
                             {
                                  '260' : 1.0,
                                  '275' : 1.0,
                                  '280' : 1.0,
                                  '300' : 1.0,
                                  '325' : 1.0,
                                  '350' : 1.0,
                                  '400' : 1.0,
                                  '450' : 1.0,
                                  '500' : 1.0,
                                  '550' : 1.0,
                                  '600' : 1.0,
                                  '700' : 1.0,
                                  '800' : 1.0,
                                  '900' : 1.0,
                                  '1000' : 1.0,
                             },
                             'lambda' : 
                             { 
                                # - 0.002644 = 2.0 * br_h_bb *br_h_yy
                                  '-20': 1.0/(0.002644*1000),   
                                  '-19': 1.0/(0.002644*1000),
                                  '-18': 1.0/(0.002644*1000),
                                  '-17': 1.0/(0.002644*1000),
                                  '-16': 1.0/(0.002644*1000),
                                  '-15': 1.0/(0.002644*1000),
                                  '-14': 1.0/(0.002644*1000),
                                  '-13': 1.0/(0.002644*1000),
                                  '-12': 1.0/(0.002644*1000),
                                  '-11': 1.0/(0.002644*1000),
                                  '-10': 1.0/(0.002644*1000),
                                  '-9' : 1.0/(0.002644*1000),
                                  '-8' : 1.0/(0.002644*1000),
                                  '-7' : 1.0/(0.002644*1000),
                                  '-6' : 1.0/(0.002644*1000),
                                  '-5' : 1.0/(0.002644*1000),
                                  '-4' : 1.0/(0.002644*1000),
                                  '-3' : 1.0/(0.002644*1000),
                                  '-2' : 1.0/(0.002644*1000),
                                  '-1' : 1.0/(0.002644*1000),
                                  '0'  : 1.0/(0.002644*1000),
                                  '1'  : 1.0/(0.002644*1000),
                                  '2'  : 1.0/(0.002644*1000),
                                  '3'  : 1.0/(0.002644*1000),
                                  '4'  : 1.0/(0.002644*1000),
                                  '5'  : 1.0/(0.002644*1000),
                                  '6'  : 1.0/(0.002644*1000),
                                  '7'  : 1.0/(0.002644*1000),
                                  '8'  : 1.0/(0.002644*1000),
                                  '9'  : 1.0/(0.002644*1000),
                                  '10' : 1.0/(0.002644*1000),
                                  '11' : 1.0/(0.002644*1000),
                                  '12' : 1.0/(0.002644*1000),
                                  '13' : 1.0/(0.002644*1000),
                                  '14' : 1.0/(0.002644*1000),
                                  '15' : 1.0/(0.002644*1000),
                                  '16' : 1.0/(0.002644*1000),
                                  '17' : 1.0/(0.002644*1000),
                                  '18' : 1.0/(0.002644*1000),
                                  '19' : 1.0/(0.002644*1000),
                                  '20' : 1.0/(0.002644*1000)
                             },
                             'lambda_statOnly' : 
                             { 
                                  # - 0.002644 = 2.0 * br_h_bb *br_h_yy
                                  '-20': 1.0/(0.002644*1000),   
                                  '-19': 1.0/(0.002644*1000),
                                  '-18': 1.0/(0.002644*1000),
                                  '-17': 1.0/(0.002644*1000),
                                  '-16': 1.0/(0.002644*1000),
                                  '-15': 1.0/(0.002644*1000),
                                  '-14': 1.0/(0.002644*1000),
                                  '-13': 1.0/(0.002644*1000),
                                  '-12': 1.0/(0.002644*1000),
                                  '-11': 1.0/(0.002644*1000),
                                  '-10': 1.0/(0.002644*1000),
                                  '-9' : 1.0/(0.002644*1000),
                                  '-8' : 1.0/(0.002644*1000),
                                  '-7' : 1.0/(0.002644*1000),
                                  '-6' : 1.0/(0.002644*1000),
                                  '-5' : 1.0/(0.002644*1000),
                                  '-4' : 1.0/(0.002644*1000),
                                  '-3' : 1.0/(0.002644*1000),
                                  '-2' : 1.0/(0.002644*1000),
                                  '-1' : 1.0/(0.002644*1000),
                                  '0'  : 1.0/(0.002644*1000),
                                  '1'  : 1.0/(0.002644*1000),
                                  '2'  : 1.0/(0.002644*1000),
                                  '3'  : 1.0/(0.002644*1000),
                                  '4'  : 1.0/(0.002644*1000),
                                  '5'  : 1.0/(0.002644*1000),
                                  '6'  : 1.0/(0.002644*1000),
                                  '7'  : 1.0/(0.002644*1000),
                                  '8'  : 1.0/(0.002644*1000),
                                  '9'  : 1.0/(0.002644*1000),
                                  '10' : 1.0/(0.002644*1000),
                                  '11' : 1.0/(0.002644*1000),
                                  '12' : 1.0/(0.002644*1000),
                                  '13' : 1.0/(0.002644*1000),
                                  '14' : 1.0/(0.002644*1000),
                                  '15' : 1.0/(0.002644*1000),
                                  '16' : 1.0/(0.002644*1000),
                                  '17' : 1.0/(0.002644*1000),
                                  '18' : 1.0/(0.002644*1000),
                                  '19' : 1.0/(0.002644*1000),
                                  '20' : 1.0/(0.002644*1000)
                                },
                        }
                   }





################################
##### ----- Scalings ----- #####
################################

scalings_releases = {
                      'r00' : {
                                'bbbb'     : bbbb_scalings['v00'],
                                'bbtautau' : bbtautau_scalings['v00'], 
                                'bbyy'     : bbyy_scalings['v00']
                              },
                    }
 

def get_scaling(release, channel, type, mass, doScaling=True):
    """Get the scaling factor for a specific release, channel, type and mass."""
    if doScaling:
        scalings = scalings_releases[release]
        return scalings[channel][type][mass]
    else:
        return 1.0

def get_scalings_dict(release):
    return scalings_releases[release]
